# -*- coding: utf-8 -*-
"""Untitled11.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1JvB9qFQzALeAm0eJ-Ki5Vaz9y52S4Sjs
"""

pip install 'openmdao[all]'

import openmdao.api as om
import numpy as np

"""![image.png](data:image/png;base64,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)"""

class FlightPathEOM2D(om.ExplicitComponent):
  """
    This class computes the values of velocity and position of the flight path using the given equations of motion
  """
  def initialize(self):
    self.options.declare('num_modes',types = int) #Idk what this line is for tbh

  def setup(self):
    self.add_input(name='m',val=1.0,units='kg',desc='mass of aircraft')
    self.add_input(name='v',val=1.0,units='m/s',desc='aircraft velocity magnitude')
    self.add_input(name='T',val=0.0,units='N',desc='thrust')
    self.add_input(name='alpha',val=0.0,units='rad',desc='angle of attack')
    self.add_input(name='L',val=0.0,units='N',desc='Lift force')
    self.add_input(name='D',val=0.0,units='N',desc='Drag Force')
    self.add_input(name='gam',val=0.0,units='rad',desc='Flight Path Angle(FPA)')

    self.add_output(name='v_dot',val=0.0,units='m/s**2',desc='velocity gradient')
    self.add_output(name='gam_dot',val=0.0,units='rad/s',desc='rate of change of FPA')
    self.add_output(name='h_dot',val=0.0,units='m/s',desc='Rate of change of altitude')
    self.add_output(name='r_dot',val=0.0,units='m/s',desc='rate of change of range')

  def setup_partials(self):
    self.declare_partials('v_dot',['T','m','alpha','gam','D'])
    self.declare_partials('gam_dot', ['T', 'L', 'm', 'gam', 'alpha', 'v'])
    self.declare_partials(['h_dot','r_dot'],['v','gam'])

  def compute(self,inputs,outputs):
    g = 9.80665
    m = inputs['m']
    T = inputs['T']
    v = inputs['v']
    alpha = inputs['alpha']
    L = inputs['L']
    D = inputs['D']
    gam = inputs['gam']

    calpha = np.cos(alpha) #Creating new variables to help us ease out the calculation of derivatives to find output
    salpha = np.sin(alpha)

    cgam = np.cos(gam)
    sgam = np.sin(gam)

    mv = m*v #For the sake of simplification

    outputs['v_dot'] = (T*calpha / m) - (D/m) - (g*salpha)
    outputs['gam_dot'] = (T*salpha / mv) + (L/mv) - (g*calpha/v)
    outputs['h_dot'] = v * sgam
    outputs['r_dot'] = v * cgam

"""Now to calculate the lift, The drag and their respective coefficients."""

class DynamicPressureComp(om.ExplicitComponent):
  def setup(self):
    self.add_input(name='rho',val=1.0,units='kg/m**3',desc='atmospheric density')
    self.add_input(name='v',val=1.0,units='m/s',desc='air-relative velocity')

    self.add_output(name='q',val=1.0,units='N/m**2',desc='Dynamic Pressure')

    self.declare_partials(of='q',wrt='rho')
    self.declare_partials(of='q',wrt='v')
    """
    My guess is that when were not using a seperate function to declare partials,
    that is when we use this respective variant of the declare partials syntax, where "of" and "wrt" come into play
    """

  def compute(self,inputs,outputs):
    outputs['q'] = 0.5 * inputs['rho'] * inputs['v']**2
    """
      Basically implementing the method of list comprehension i guess (condensing all lines of code into 1)
    """

class LiftDragForce(om.ExplicitComponent):
  def initialise(self):
    self.options.declare('num_modes',types=int)


  def setup(self):
    self.add_input(name='CL',val=0.0,desc='Lift Coefficient')
    self.add_input(name='CD',val=0.0,desc='Drag Coefficient')
    self.add_input(name='q',val=0.0,units='N/m**2',desc='Dynamic Pressure')
    self.add_input(name='S',val=0.0,units='m**2',desc='Aerodynamic Reference Area')

    self.add_output(name='f_lift',shape=(1, ),units='N',desc='Aerodynamic Lift Force')
    self.add_output(name='f_drag',shape=(1, ),units='N',desc='Aerodynamic Drag Force')

    self.declare_partials(of='f_lift',wrt=['q','S','CL'])
    self.declare_partials(of='f_drag',wrt=['q','S','CD'])


  def compute(self,inputs,outputs):
    q = inputs['q']
    S = inputs['S']
    CL = inputs['CL']
    CD = inputs['CD']

    qS = q*S

    outputs['f_lift'] = qS * CL
    outputs['f_drag'] = qS * CD

class CannonballODE(om.Group):
  def setup(self):
    self.add_subsystem(name='dynamic_pressure',subsys=DynamicPressureComp(),promotes=['*'])
    self.add_subsystem(name='aero',subsys=LiftDragForce(),promotes_inputs=['*'])
    self.add_subsystem(name='eom',subsys=FlightPathEOM2D(),promotes=['*'])

    self.connect('aero.f_drag','D')
    self.connect('aero.f_lift','L')

"""To calculate the range, given the initial flight path angle and velocity, we use the Euler Integration method by predefining a time step ( First order method)

![image.png](data:image/png;base64,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)
"""

from scipy.optimize import minimize

def eval_cannonball_range(gam_init,prob,complex_step = False):
  dt = 0.1 #Time step
  h_init = 1.0 #Height of Cannon
  v_init = 100.0 #Initial Velocity of cannon ball
  h_target = 0.0 #Final height of cannonball

  v = v_init
  gam = gam_init
  h = h_init
  r = 0.0
  t = 0.0

  if complex_step:
    prob.set_complex_step_mode(True)

  while h > h_target:
    #Setting values
    prob.set_val('v',v)
    prob.set_val('gam',gam,units='deg')

    #Run the model
    prob.run_model()

    #Extracting the rates
    v_dot = prob.get_val('v_dot')
    gam_dot = prob.get_val('gam_dot',units='deg/s')
    h_dot = prob.get_val('h_dot')
    r_dot = prob.get_val('r_dot')

    h_last = h
    r_last = r

    #Euler Integration
    v = v + (dt * v_dot)
    gam = gam + (dt * gam_dot)
    h = h + (dt * h_dot)
    r = r + (dt * r_dot)
    t += dt
    #print(v,gam,h,r,t)

  #Linear Interpolation b/w last 2 points to get an accurate landign point
  r_final = r_last + (r - r_last) * h_last / (h_last - h)

  if complex_step:
    prob.set_complex_step_mode(False)

  print(f"Distance: {r_final}, Time: {t}, Angle: {gam_init}")
  return -r_final


def gradient_cannonball_range(gam_init, prob):
  """
  Uses complex step to compute gradient of range wrt initial angle.

  Parameters
    ----------
    gam_init : float
        Initial cannonball firing angle in degrees.
    prob : <Problem>
        OpenMDAO problem that contains the equations of motion.

    Returns
    -------
    float
        Derivative of range wrt initial angle in m/deg.
    """
  step = 1.0e-14
  dr_dgam = eval_cannonball_range(gam_init + step * 1j, prob, complex_step=True)
  return dr_dgam.imag / step

prob = om.Problem(model=CannonballODE())
prob.setup(force_alloc_complex=True)

# Set constants
prob.set_val('CL', 0.0)                          # Lift Coefficient
prob.set_val('CD', 0.05)                         # Drag Coefficient
prob.set_val('S', 0.25 * np.pi, units='ft**2')   # Wetted Area (1 ft diameter ball)
prob.set_val('rho', 1.225)                       # Atmospheric Density
prob.set_val('m', 5.5)                           # Cannonball Mass

prob.set_val('alpha', 0.0)                       # Angle of Attack (Not Applicable)
prob.set_val('T', 0.0)                           # Thrust (Not Applicable)

result = minimize(eval_cannonball_range, 27.0,method='SLSQP',jac=gradient_cannonball_range,args=(prob))

print(result['x'])